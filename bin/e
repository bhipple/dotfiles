#!/usr/bin/env bash
# Open a file with emacsclient, detecting if we should use TRAMP to get to the
# machine where emacs is running.

if [ -z "$1" ]; then
    echo "USAGE: e <file>"
    exit 1
fi

host=$(hostname)
file_name=$(realpath "$1")
if [ "$host" = "$EMACS_HOST"  ] || [[ "$host" = brh* ]]; then
    emacsclient -q -n "$file_name" &
else
    ssh "$EMACS_HOST" "cd /tmp; nohup emacsclient -q -n /$host:$file_name" &
fi
