#!/usr/bin/env bash
if [ -z "$EMACS_HOST" ]; then
    echo "Required: \$EMACS_HOST variable set to hostname where the emacs server is running."
    exit 1
fi

if [ -z "$1" ]; then
    echo "USAGE: e <file>"
    exit 1
fi

host=$(hostname)
file_name=$(realpath "$1")
if [ "$host" = "$EMACS_HOST" ]; then
    emacsclient "$file_name" &
else
    ssh "$EMACS_HOST" "cd /tmp; nohup emacsclient /$host:$file_name" &
fi
